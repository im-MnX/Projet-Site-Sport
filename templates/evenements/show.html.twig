{% extends 'base.html.twig' %}

{% block javascripts %}
	{{ parent() }}
	<script>
		document.addEventListener('DOMContentLoaded', function () {
			document.querySelectorAll('oembed[url]').forEach(element => {
				const url = element.getAttribute('url');
				let embedCode = '';

				if (url.includes('youtube.com') || url.includes('youtu.be')) {
					const videoId = url.split('v=')[1] || url.split('/').pop().split('?')[0];
					embedCode = `<iframe width="100%" height="450" src="https://www.youtube.com/embed/${videoId}" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>`;
				} else if (url.includes('vimeo.com')) {
					const videoId = url.split('/').pop();
					embedCode = `<iframe src="https://player.vimeo.com/video/${videoId}" width="100%" height="450" frameborder="0" allow="autoplay; fullscreen; picture-in-picture" allowfullscreen></iframe>`;
				}

				if (embedCode) {
					const container = document.createElement('div');
					container.className = 'video-container';
					container.innerHTML = embedCode;
					element.parentNode.replaceChild(container, element);
				}
			});
		});
	</script>
{% endblock %}
{% block title %}
	Événements
{% endblock %}

{% block body %}
	<link rel="stylesheet" href="{{ asset('css/actualites.css') }}">

	<div class="event-poster-header">
		<div class="poster-header-container">
			{% if evenement.images %}
				<div class="poster-wrapper">
					<img src="{{ asset('uploads/evenements/' ~ evenement.images) }}" alt="{{ evenement.nom }}" class="poster-image">
				</div>
			{% endif %}

			<div class="poster-info">
				{% if evenement.typeEvenement %}
					<span class="poster-category">{{ evenement.typeEvenement.libelleTypeEvenement }}</span>
				{% endif %}
				<h1>{{ evenement.nom }}</h1>
				
				<div class="poster-meta-list">
					<div class="poster-meta-item">
						<i class="fas fa-calendar-alt"></i>
						<div class="poster-meta-content">
							<div class="poster-label">Date de l'événement</div>
							<strong>{{ evenement.dateEvenement ? evenement.dateEvenement|date('d F Y', 'Europe/Paris') : '-' }}</strong>
						</div>
					</div>
					{% if evenement.horaire %}
						<div class="poster-meta-item">
							<i class="fas fa-clock"></i>
							<div class="poster-meta-content">
								<div class="poster-label">Heure de début</div>
								<strong>{{ evenement.horaire|date('H:i') }}</strong>
							</div>
						</div>
					{% endif %}
				</div>
			</div>
		</div>
	</div>

	<div class="event-content-section">
		<div class="rich-content" style="font-size: 1.2rem; line-height: 1.8;">
			{{ evenement.description|raw }}
		</div>

		<div class="action-cards">
			{% if evenement.brochureFilename %}
				<div class="action-card">
					<i class="fas fa-file-pdf" style="font-size: 2.5rem; color: var(--primary-blue); margin-bottom: 1rem;"></i>
					<h3>Dossier d'inscription</h3>
					<p style="color: var(--text-gray); margin-bottom: 2rem;">Téléchargez le programme complet et les modalités d'inscription.</p>
					<a href="{{ asset('uploads/brochures/' ~ evenement.brochureFilename) }}" class="btn-poster" target="_blank">
						<i class="fas fa-download"></i> Télécharger le PDF
					</a>
				</div>
			{% endif %}

			<div class="action-card">
				<i class="fas fa-info-circle" style="font-size: 2.5rem; color: var(--primary-blue); margin-bottom: 1rem;"></i>
				<h3>Navigation</h3>
				<p style="color: var(--text-gray); margin-bottom: 2rem;">Explorez nos autres événements ou contactez-nous.</p>
				<div style="display: flex; gap: 1rem; justify-content: center;">
					<a href="{{ path('app_evenement') }}" class="btn-poster btn-poster-outline">
						<i class="fas fa-arrow-left"></i> Retour
					</a>
					<a href="{{ path('contact') }}" class="btn-poster">
						<i class="fas fa-envelope"></i> Contact
					</a>
				</div>
			</div>
		</div>
	</div>
{% endblock %}
